(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{431:function(n,t,i){"use strict";i.r(t);var e=i(2),s=Object(e.a)({},(function(){var n=this,t=n._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("p",[n._v("from requests_html import HTMLSession\nfrom urllib.request import unquote\nimport os")]),n._v(" "),t("p",[n._v("'''\nredmine系统通过bug号解析页面内容及下载附件\n'''")]),n._v(" "),t("p",[n._v("base_url = ''\ncookies = dict(\n_redmine_session='')\nsession = HTMLSession()")]),n._v(" "),t("p",[n._v("def get_bug(num):\nurl_sit = base_url % num\nr = session.get(url_sit, cookies=cookies)\nprint('BUG地址 : ', r.html, '\\n\\n')\n# 解析内容节点\nprint('====================开始时间====================')\nprint(r.html.xpath('//table[@class=\"attributes\"]/tr[1]/td[2]/text()'), '\\n\\n')\nhtml = r.html.xpath('//div[@id=\"history\"]/div')\nprint('====================BUG描述====================')\nprint(r.html.xpath('//div[@class=\"description\"]/div[2]/p/text()'), '\\n\\n')\nprint('====================更新记录====================')\nfor item in html:\nprint(item.xpath('//div/h4/a/text()'))\nprint(item.xpath('//div/div/p/text()'), '\\n\\n')\n# 解析附件节点\nhtml = r.html.xpath('//div[@class=\"attachments\"]/p/a/@href')\nif len(html) > 0:\ncreate_subsidiary_dir(num)\nfor item in html:\nif 'download' in item:\nsave_subsidiary('http://poopabc.vicp.cc:90' + item, num)\nprint('下载完毕')")]),n._v(" "),t("p",[n._v("def create_subsidiary_dir(dirs):\nif not os.path.exists(dirs):\nos.mkdir(dirs)")]),n._v(" "),t("p",[n._v("def save_subsidiary(url, num):\nprint('附件地址 ：', url)\nr = session.get(url, cookies=cookies)\nwith open(num + '/' + unquote(os.path.basename(url), encoding='utf-8'), 'wb') as wf:\nwf.write(r.content)")]),n._v(" "),t("p",[n._v("if "),t("strong",[n._v("name")]),n._v(" == '"),t("strong",[n._v("main")]),n._v("':\nindex = input('请输入BUG号\\n')\nget_bug(index)")])])}),[],!1,null,null,null);t.default=s.exports}}]);