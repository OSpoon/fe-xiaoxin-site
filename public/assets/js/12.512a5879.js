(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{412:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"title"}),n("p",[s._v("在几年前的一次 Vue 项目改造中利用原生+H5 的形式按模块菜单来拆分了多个 Vue 项目，在拆分时考虑到多项目维护带来的成本较大，我们将项目公共使用到的资源提升到项目 root 目录下，将子项目抽取为模板通过定制的脚手架创建每个子项目到 modules 下，并且支持单独打包、单独发布。这样项目结构的好处同时避免了项目庞大带来的首屏加载时间长，也避免了多人开发出现冲突的造成的矛盾。")])]),s._v(" "),n("h2",{attrs:{id:"写作背景"}},[s._v("写作背景：")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("在几年前的一次 Vue 项目改造中利用原生+H5 的形式按模块菜单来拆分了多个 Vue 项目，在拆分时考虑到多项目维护带来的成本较大，我们将项目公共使用到的资源提升到项目 root 目录下，将子项目抽取为模板通过定制的脚手架创建每个子项目到 modules 下，并且支持单独打包、单独发布。这样项目结构的好处同时避免了项目庞大带来的首屏加载时间长，也避免了多人开发出现冲突的造成的矛盾。")]),s._v(" "),n("p",[s._v("这样的项目结构在现在看来很多项目都有在使用，比如 Vue、Vite 等，它们共同使用到的 PNPM 的包管理器来组织这样的项目。同时我也在 B 站发现有伙伴使用 PNPM 组建了包含 PC 前端、PC 后端、H5 前端这样的项目模板。")]),s._v(" "),n("p",[s._v("我们一起来搞一搞~")]),s._v(" "),n("h2",{attrs:{id:"pnpm-介绍"}},[s._v("PNPM 介绍：")]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"pnpm-的特点"}},[s._v("PNPM 的特点：")]),s._v(" "),n("ol",[n("li",[s._v("节约磁盘空间并提升安装速度；")]),s._v(" "),n("li",[s._v("创建非扁平化的 node_modules 文件夹。")])]),s._v(" "),n("h3",{attrs:{id:"pnpm-与-nodejs-版本支持"}},[s._v("PNPM 与 NodeJs 版本支持：")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("Node.js")]),s._v(" "),n("th",[s._v("pnpm 4")]),s._v(" "),n("th",[s._v("pnpm 5")]),s._v(" "),n("th",[s._v("pnpm 6")]),s._v(" "),n("th",[s._v("pnpm 7")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("Node.js 10")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("❌")]),s._v(" "),n("td",[s._v("❌")])]),s._v(" "),n("tr",[n("td",[s._v("Node.js 12")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("❌")])]),s._v(" "),n("tr",[n("td",[s._v("Node.js 14")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")])]),s._v(" "),n("tr",[n("td",[s._v("Node.js 16")]),s._v(" "),n("td",[s._v("未知")]),s._v(" "),n("td",[s._v("未知")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")])]),s._v(" "),n("tr",[n("td",[s._v("Node.js 18")]),s._v(" "),n("td",[s._v("未知")]),s._v(" "),n("td",[s._v("未知")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")])])])]),s._v(" "),n("p",[s._v("上述表格来自："),n("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fpnpm.io%2Fzh%2Finstallation",title:"https://pnpm.io/zh/installation",target:"_blank",rel:"noopener noreferrer"}},[s._v("pnpm.io/zh/installa…"),n("OutboundLink")],1),s._v("；")]),s._v(" "),n("h3",{attrs:{id:"pnpm-与其他包管理功能对比"}},[s._v("PNPM 与其他包管理功能对比：")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("功能")]),s._v(" "),n("th",[s._v("pnpm")]),s._v(" "),n("th",[s._v("Yarn")]),s._v(" "),n("th",[s._v("npm")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("工作空间支持（monorepo）")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")])]),s._v(" "),n("tr",[n("td",[s._v("隔离的 node_modules")]),s._v(" "),n("td",[s._v("✔️ - 默认")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("❌")])]),s._v(" "),n("tr",[n("td",[s._v("提升的 node_modules")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️ - 默认")])]),s._v(" "),n("tr",[n("td",[s._v("自动安装 peers")]),s._v(" "),n("td",[s._v("✔️ - 通过 "),n("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fpnpm.io%2Fzh%2Fnpmrc%23auto-install-peers",title:"https://pnpm.io/zh/npmrc#auto-install-peers",target:"_blank",rel:"noopener noreferrer"}},[s._v("auto-install-peers=true"),n("OutboundLink")],1)]),s._v(" "),n("td",[s._v("❌")]),s._v(" "),n("td",[s._v("✔️")])]),s._v(" "),n("tr",[n("td",[s._v("Plug'n'Play")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️ - 默认")]),s._v(" "),n("td",[s._v("❌")])]),s._v(" "),n("tr",[n("td",[s._v("零安装")]),s._v(" "),n("td",[s._v("❌")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("❌")])]),s._v(" "),n("tr",[n("td",[s._v("修补依赖项")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("❌")])]),s._v(" "),n("tr",[n("td",[s._v("管理 Node.js 版本")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("❌")]),s._v(" "),n("td",[s._v("❌")])]),s._v(" "),n("tr",[n("td",[s._v("有锁文件")]),s._v(" "),n("td",[s._v("✔️ - pnpm-lock.yaml")]),s._v(" "),n("td",[s._v("✔️ - yarn.lock")]),s._v(" "),n("td",[s._v("✔️ - package-lock.json")])]),s._v(" "),n("tr",[n("td",[s._v("支持覆盖")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("✔️ - 通过 resolutions")]),s._v(" "),n("td",[s._v("✔️")])]),s._v(" "),n("tr",[n("td",[s._v("内容可寻址存储")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("❌")]),s._v(" "),n("td",[s._v("❌")])]),s._v(" "),n("tr",[n("td",[s._v("动态包执行")]),s._v(" "),n("td",[s._v("✔️ - 通过 pnpm dlx")]),s._v(" "),n("td",[s._v("✔️ - 通过 yarn dlx")]),s._v(" "),n("td",[s._v("✔️ - 通过 npx")])]),s._v(" "),n("tr",[n("td",[s._v("Side-effects cache")]),s._v(" "),n("td",[s._v("✔️")]),s._v(" "),n("td",[s._v("❌")]),s._v(" "),n("td",[s._v("❌")])])])]),s._v(" "),n("p",[s._v("上述表格来自："),n("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fpnpm.io%2Fzh%2Ffeature-comparison",title:"https://pnpm.io/zh/feature-comparison",target:"_blank",rel:"noopener noreferrer"}},[s._v("pnpm.io/zh/feature-…"),n("OutboundLink")],1),s._v("；")]),s._v(" "),n("h3",{attrs:{id:"安装-pnpm"}},[s._v("安装 PNPM：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm install -g pnpm\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"快速开始命令"}},[s._v("快速开始命令：")]),s._v(" "),n("ol",[n("li",[s._v("在项目root目录安装所有依赖："),n("code",[s._v("pnpm install")]),s._v("；")]),s._v(" "),n("li",[s._v("在项目root目录安装指定依赖："),n("code",[s._v("pnpm add <pkg>")]),s._v(";")]),s._v(" "),n("li",[s._v("在项目root目录运行CMD命令："),n("code",[s._v("pnpm <cmd>")]),s._v(";")]),s._v(" "),n("li",[s._v("在特定子集运行CMD命令："),n("code",[s._v("pnpm -F <package_selector> <command>")]),s._v("；")])]),s._v(" "),n("h2",{attrs:{id:"一起搞起来"}},[s._v("一起搞起来：")]),s._v(" "),n("hr"),s._v(" "),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15506cf4e3e74863ac32eda047179799~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("h3",{attrs:{id:"利用-vue-3-模板来创建-root-项目"}},[s._v("利用 vue@3 模板来创建 root 项目：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pnpm create vue@3\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3420b42b1c074caca0ef5303e2977c56~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("h3",{attrs:{id:"定义工作空间目录结构"}},[s._v("定义工作空间目录结构")]),s._v(" "),n("p",[s._v("使用 "),n("strong",[s._v("pnpm")]),s._v(" 管理的项目支持在 "),n("strong",[s._v("root")]),s._v(" 目录下使用 "),n("code",[s._v("pnpm-workspace.yaml")]),s._v(" 文件来定义工作空间目录")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("packages:\n  # all packages in direct subdirs of packages/\n  - 'packages/*'\n  # all packages in subdirs of components/\n  - 'components/**'\n  # 获取数据相关的包在 apis 目录下\n  - 'apis/**'\n  # 通用工具相关的包在 utils 目录下\n  - 'utils/**'\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"使用-vite-来初始化公共模块"}},[s._v("使用 vite 来初始化公共模块：")]),s._v(" "),n("p",[s._v("使用 vite 内置的基础项目模板创建 apis、utils两个公共模块")]),s._v(" "),n("h4",{attrs:{id:"创建-apis-项目"}},[s._v("创建 apis 项目：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("yarn create vite\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ac12818f28246029e75bc26e5aa34b8~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("h4",{attrs:{id:"创建-utils-项目"}},[s._v("创建 utils 项目：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("yarn create vite\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c20c28535bb8447991f4c15157ef4b77~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("h4",{attrs:{id:"调整-apis、utils-的项目名称和版本号"}},[s._v("调整 apis、utils 的项目名称和版本号：")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("strong",[s._v("项目")])]),s._v(" "),n("th",[n("strong",[s._v("name字段更新")])]),s._v(" "),n("th",[n("strong",[s._v("version字段更新")])])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("apis")]),s._v(" "),n("td",[s._v("apis -> @it200/apis")]),s._v(" "),n("td",[s._v("0.0.0 -> 0.0.1")])]),s._v(" "),n("tr",[n("td",[s._v("utils")]),s._v(" "),n("td",[s._v("utils -> @it200/utils")]),s._v(" "),n("td",[s._v("0.0.0 -> 0.0.1")])])])]),s._v(" "),n("h3",{attrs:{id:"使用-vite-来初始化业务模块"}},[s._v("使用 vite 来初始化业务模块：")]),s._v(" "),n("p",[s._v("业务模块创建到 packages 目录下，创建命令同上一小节，我们这次改用 vite 内置的 vue-ts 模板")]),s._v(" "),n("h4",{attrs:{id:"创建三个module项目-整体的目录大致结构如下"}},[s._v("创建三个module项目，整体的目录大致结构如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("my-workspace                       \n├─ apis                            \n│  ├─ src                                                                                   \n│  ├─ package.json                 \n│  └─ tsconfig.json     \n├─ utils                           \n│  ├─ src                                                                                  \n│  ├─ package.json                 \n│  └─ tsconfig.json  \n├─ packages                        \n│  ├─ module1                                 \n│  ├─ module2                                \n│  └─ module3                                \n├─ public                                         \n├─ src                                                         \n├─ env.d.ts                        \n├─ index.html                      \n├─ package.json                    \n├─ pnpm-lock.yaml                  \n├─ pnpm-workspace.yaml             \n├─ README.md                       \n├─ tsconfig.config.json            \n├─ tsconfig.json                   \n└─ vite.config.ts                  \n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("h4",{attrs:{id:"调整三个模块项目的名称和版本号"}},[s._v("调整三个模块项目的名称和版本号")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("strong",[s._v("项目")])]),s._v(" "),n("th",[n("strong",[s._v("name字段更新")])]),s._v(" "),n("th",[n("strong",[s._v("version字段更新")])])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("module1")]),s._v(" "),n("td",[s._v("module1 -> @it200/module1")]),s._v(" "),n("td",[s._v("0.0.0 -> 0.0.1")])]),s._v(" "),n("tr",[n("td",[s._v("module2")]),s._v(" "),n("td",[s._v("module2 -> @it200/module2")]),s._v(" "),n("td",[s._v("0.0.0 -> 0.0.1")])]),s._v(" "),n("tr",[n("td",[s._v("module3")]),s._v(" "),n("td",[s._v("module3 -> @it200/module3")]),s._v(" "),n("td",[s._v("0.0.0 -> 0.0.1")])])])]),s._v(" "),n("h4",{attrs:{id:"统一包管理器的使用"}},[s._v("统一包管理器的使用：")]),s._v(" "),n("p",[s._v("在创建的各模块的 "),n("code",[s._v("package.json")]),s._v(" 中增加一条"),n("code",[s._v("script")]),s._v("，内容如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('"preinstall": "npx only-allow pnpm"\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"开发utils模块"}},[s._v("开发utils模块：")]),s._v(" "),n("h4",{attrs:{id:"开发clipboard工具类-支持移动端和pc端两种提示风格"}},[s._v("开发Clipboard工具类（支持移动端和PC端两种提示风格）：")]),s._v(" "),n("h5",{attrs:{id:"准备clipboard工具类"}},[s._v("准备Clipboard工具类：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import Clipboard from 'clipboard'\n\nexport const handleClipboard = (text: string, event: MouseEvent) => {\n  const clipboard = new Clipboard(event.target as Element, {\n    text: () => text\n  })\n  clipboard.on('success', () => {\n    clipboard.destroy()\n  })\n  clipboard.on('error', () => {\n    clipboard.destroy()\n  });\n  (clipboard as any).onClick(event)\n}\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h5",{attrs:{id:"配置相关依赖"}},[s._v("配置相关依赖：")]),s._v(" "),n("ol",[n("li",[s._v("安装"),n("code",[s._v("vueuse")]),s._v("依赖库，监听屏幕变化；")]),s._v(" "),n("li",[s._v("安装"),n("code",[s._v("clipboard")]),s._v("依赖库，完成粘贴板基础功能；")]),s._v(" "),n("li",[s._v("安装"),n("code",[s._v("element-plus")]),s._v("PC风格组件库；")]),s._v(" "),n("li",[s._v("安装"),n("code",[s._v("vant")]),s._v("移动端风格组件库；")]),s._v(" "),n("li",[s._v("安装"),n("code",[s._v("vue")]),s._v("依赖库，因提示Issues with peer dependencies found，就先装上。")])]),s._v(" "),n("h5",{attrs:{id:"完善clipboard工具类以支持不同风格提示"}},[s._v("完善Clipboard工具类以支持不同风格提示：")]),s._v(" "),n("p",[s._v("utils\\src\\clipboard.ts")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('// 手动导入vant中的通知组件及样式文件\nimport { Notify } from "vant";\nimport "vant/es/notify/style";\n\n// 手动导入element-plus中的通知组件及样式文件\nimport { ElMessage } from "element-plus";\nimport "element-plus/es/components/message/style/css";\n\n// 导入剪切板基础依赖\nimport Clipboard from "clipboard";\n// 导入vueuse/core 中监听浏览器端点变化的函数\nimport { useBreakpoints, breakpointsTailwind } from "@vueuse/core";\n\nconst sm = useBreakpoints(breakpointsTailwind).smaller("sm");\n\n/* 依据sm值的变化来改变使用不同的通知风格 */\nexport const clipboardSuccess = () =>\n  sm.value\n    ? Notify({\n        message: "Copy successfully",\n        type: "success",\n        duration: 1500,\n      })\n    : ElMessage({\n        message: "Copy successfully",\n        type: "success",\n        duration: 1500,\n      });\n\n/* 依据sm值的变化来改变使用不同的通知风格 */\nexport const clipboardError = () =>\n  sm.value\n    ? Notify({\n        message: "Copy failed",\n        type: "danger",\n      })\n    : ElMessage({\n        message: "Copy failed",\n        type: "error",\n      });\n\nexport const handleClipboard = (text: string, event: MouseEvent) => {\n  const clipboard = new Clipboard(event.target as Element, {\n    text: () => text,\n  });\n  clipboard.on("success", () => {\n    // 在复制成功后提示成功通知内容\n    clipboardSuccess();\n    clipboard.destroy();\n  });\n  clipboard.on("error", () => {\n    // 在复制失败后提示失败通知内容\n    clipboardError();\n    clipboard.destroy();\n  });\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (clipboard as any).onClick(event);\n};\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br")])]),n("h5",{attrs:{id:"导出工具类的相关配置"}},[s._v("导出工具类的相关配置：")]),s._v(" "),n("ol",[n("li",[s._v("配置统一导出文件（"),n("code",[s._v("utils\\index.ts")]),s._v("）：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('export * from "./src/clipboard";\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("修改"),n("code",[s._v("package.json")]),s._v("的"),n("code",[s._v("main")]),s._v("字段：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "main": "index.ts"\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h5",{attrs:{id:"将utils模块安装到module1项目"}},[s._v("将utils模块安装到module1项目：")]),s._v(" "),n("ol",[n("li",[s._v("下面的命令在root目录执行，通过"),n("code",[s._v("-F")]),s._v("来执行命令执行的位置是"),n("code",[s._v("@it200/module1")]),s._v("，执行的命令是"),n("code",[s._v("add")]),s._v("。")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pnpm -F @it200/module1 add @it200/utils\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("注：当"),n("code",[s._v("@it200/utils")]),s._v("包升级后，执行执行"),n("code",[s._v("pnpm update")]),s._v("来更新相关依赖版本。")]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("安装成功后的依赖信息如下：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "dependencies": {\n    "@it200/utils": "workspace:^0.0.1"\n  }\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h5",{attrs:{id:"在module1项目中尝试使用clipboard函数"}},[s._v("在module1项目中尝试使用Clipboard函数：")]),s._v(" "),n("ol",[n("li",[s._v("在模板中增加按钮：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<button @click="copy">复制</button>\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("在"),n("code",[s._v("setup")]),s._v("的"),n("code",[s._v("script")]),s._v("中增加对应函数并导入"),n("code",[s._v("handleClipboard")]),s._v("：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import { handleClipboard } from "@it200/utils";\nconst copy = (e) => {\n  console.log("[ e ] >", e);\n  handleClipboard("haha", e);\n};\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("PC端复制成功后提示风格：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9dd59a76f959487da3d31b6ab1537e21~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("p",[s._v("移动端复制成功后提示风格：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/62d90741d2ca43c28fa88966c9986e3b~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("h3",{attrs:{id:"开发-apis-模块"}},[s._v("开发 apis 模块：")]),s._v(" "),n("h4",{attrs:{id:"开发axios工具类函数"}},[s._v("开发axios工具类函数：")]),s._v(" "),n("h5",{attrs:{id:"准备axios工具类"}},[s._v("准备axios工具类：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import axios, { AxiosRequestConfig } from "axios";\n\nconst pending = {};\n\nconst CancelToken = axios.CancelToken;\nconst removePending = (key: string, isRequest = false) => {\n  if (Reflect.get(pending, key) && isRequest) {\n    Reflect.get(pending, key)("取消重复请求");\n  }\n  Reflect.deleteProperty(pending, key);\n};\nconst getRequestIdentify = (config: AxiosRequestConfig, isReuest = false) => {\n  let url = config.url;\n  const suburl = config.url?.substring(1, config.url?.length) ?? "";\n  if (isReuest) {\n    url = config.baseURL + suburl;\n  }\n  return config.method === "get"\n    ? encodeURIComponent(url + JSON.stringify(config.params))\n    : encodeURIComponent(config.url + JSON.stringify(config.data));\n};\n\n// 创建一个AXIOS实例\nconst service = axios.create({\n  baseURL: import.meta.env.VITE_BASE_API, // url = base url + request url\n  // withCredentials: true, // send cookies when cross-domain requests\n  timeout: 16000, // 请求超时\n});\n\n// 请求拦截器\nservice.interceptors.request.use(\n  (config: AxiosRequestConfig) => {\n    // 拦截重复请求(即当前正在进行的相同请求)\n    const requestData = getRequestIdentify(config, true);\n    removePending(requestData, true);\n\n    config.cancelToken = new CancelToken((c: any) => {\n      Reflect.set(pending, requestData, c);\n    });\n\n    // 请求发送前的预处理(如:获取token等)\n    // if (store.getters.token) {\n    //   // let each request carry token\n    //   // [\'X-AUTH-TOKEN\'] is a custom headers key\n    //   // please modify it according to the actual situation\n    //   config.headers[\'X-AUTH-TOKEN\'] = getToken()\n    // }\n    return config;\n  },\n  (error: any) => {\n    // do something with request error\n    console.log(error); // for debug\n    return Promise.reject(error);\n  }\n);\n\n// response interceptor\nservice.interceptors.response.use(\n  (response: { config: AxiosRequestConfig; data: any }) => {\n    // 把已经完成的请求从 pending 中移除\n    const requestData = getRequestIdentify(response.config);\n    removePending(requestData);\n    const res = response.data;\n    return res;\n  },\n  (error: {\n    message: string;\n    config: { showLoading: any };\n    response: { status: any };\n    request: any;\n  }) => {\n    console.log(error.message);\n    if (error) {\n      if (error.response) {\n        switch (error.response.status) {\n          case 400:\n            error.message = "错误请求";\n            break;\n          case 401:\n            error.message = "未授权，请重新登录";\n            break;\n          default:\n            error.message = `连接错误${error.response.status}`;\n        }\n        const errData = {\n          code: error.response.status,\n          message: error.message,\n        };\n        console.log("统一错误处理: ", errData);\n      } else if (error.request) {\n        console.log("统一错误处理: ", "网络出错，请稍后重试");\n      }\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport default service;\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br")])]),n("h5",{attrs:{id:"配置相关依赖-2"}},[s._v("配置相关依赖：")]),s._v(" "),n("ol",[n("li",[s._v("安装"),n("code",[s._v("axios")]),s._v("依赖库，完成数据请求的发送及处理；")]),s._v(" "),n("li",[s._v("安装"),n("code",[s._v("vant")]),s._v("依赖库，完成请求数据后的状态提示等。")])]),s._v(" "),n("p",[s._v("说明：在"),n("code",[s._v("apis")]),s._v("模块中就不再做手机端和PC端的风格切换了；")]),s._v(" "),n("h5",{attrs:{id:"完善axios工具类"}},[s._v("完善axios工具类：")]),s._v(" "),n("p",[s._v("apis\\src\\axios.ts，部分逻辑有删减，仅保证基础功能正常")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import { Dialog } from "vant";\nimport "vant/es/dialog/style";\n\nimport { Toast } from "vant";\nimport "vant/es/toast/style";\n\nimport axios, { AxiosRequestConfig } from "axios";\n\nconst pending = {};\n\nconst CancelToken = axios.CancelToken;\nconst removePending = (key: string, isRequest = false) => {\n  if (Reflect.get(pending, key) && isRequest) {\n    Reflect.get(pending, key)("取消重复请求");\n  }\n  Reflect.deleteProperty(pending, key);\n};\nconst getRequestIdentify = (config: AxiosRequestConfig, isReuest = false) => {\n  let url = config.url;\n  const suburl = config.url?.substring(1, config.url?.length) ?? "";\n  if (isReuest) {\n    url = config.baseURL + suburl;\n  }\n  return config.method === "get"\n    ? encodeURIComponent(url + JSON.stringify(config.params))\n    : encodeURIComponent(config.url + JSON.stringify(config.data));\n};\n\n// 创建一个AXIOS实例\nconst service = axios.create({\n  baseURL: import.meta.env.VITE_BASE_API, // url = base url + request url\n  // withCredentials: true, // send cookies when cross-domain requests\n  timeout: 16000, // 请求超时\n});\n\n// 请求拦截器\nservice.interceptors.request.use(\n  (config: AxiosRequestConfig) => {\n    // 拦截重复请求(即当前正在进行的相同请求)\n    const requestData = getRequestIdentify(config, true);\n    removePending(requestData, true);\n\n    config.cancelToken = new CancelToken((c: any) => {\n      Reflect.set(pending, requestData, c);\n    });\n\n    // 是否开启loading\n    if (config.showLoading) {\n      Toast.loading({\n        duration: 0,\n        mask: true,\n        forbidClick: true,\n        message: "加载中...",\n        loadingType: "spinner",\n      });\n    }\n\n    // 请求发送前的预处理(如:获取token等)\n    // if (store.getters.token) {\n    //   // let each request carry token\n    //   // [\'X-AUTH-TOKEN\'] is a custom headers key\n    //   // please modify it according to the actual situation\n    //   config.headers[\'X-AUTH-TOKEN\'] = getToken()\n    // }\n    return config;\n  },\n  (error: any) => {\n    // do something with request error\n    console.log(error); // for debug\n    Toast.loading({\n      message: "网络出错，请重试",\n      duration: 1500,\n      type: "fail",\n    });\n    return Promise.reject(error);\n  }\n);\n\n// response interceptor\nservice.interceptors.response.use(\n  (response: { config: AxiosRequestConfig; data: any }) => {\n    // 把已经完成的请求从 pending 中移除\n    const requestData = getRequestIdentify(response.config);\n    removePending(requestData);\n\n    if (response.config.showLoading) {\n      Toast.clear();\n    }\n\n    const res = response.data;\n    return res;\n  },\n  (error: {\n    message: string;\n    config: { showLoading: any };\n    response: { status: any };\n    request: any;\n  }) => {\n    console.log(error.message);\n    if (error) {\n      if (error.config && error.config.showLoading) {\n        Toast.clear();\n      }\n      if (error.response) {\n        switch (error.response.status) {\n          case 400:\n            error.message = "错误请求";\n            break;\n          case 401:\n            error.message = "未授权，请重新登录";\n            break;\n          default:\n            error.message = `连接错误${error.response.status}`;\n        }\n        const errData = {\n          code: error.response.status,\n          message: error.message,\n        };\n        console.log("统一错误处理: ", errData);\n        Dialog({ title: "提示", message: errData.message || "Error" });\n      } else if (error.request) {\n        Toast.loading({\n          message: "网络出错，请稍后重试",\n          duration: 1500,\n          type: "fail",\n        });\n      }\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport default service;\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br")])]),n("h5",{attrs:{id:"编写userapi类-汇总关于user对象的数据读取"}},[s._v("编写userApi类，汇总关于user对象的数据读取：")]),s._v(" "),n("p",[s._v("apis\\src\\user.ts")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import service from "./axios";\n\nexport const UserApi = {\n  getUsers: () => service.get<any>("/users"),\n};\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h5",{attrs:{id:"导出userapi类的相关配置"}},[s._v("导出userApi类的相关配置：")]),s._v(" "),n("ol",[n("li",[s._v("配置统一导出文件（"),n("code",[s._v("apis\\index.ts")]),s._v("）：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('export * from "./src/user";\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("修改"),n("code",[s._v("package.json")]),s._v("的"),n("code",[s._v("main")]),s._v("字段：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "main": "index.ts"\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h5",{attrs:{id:"在module2项目中尝试使用userapi类"}},[s._v("在module2项目中尝试使用userApi类：")]),s._v(" "),n("ol",[n("li",[s._v("定义模板：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<template>\n  <button @click="getUserList">获取用户列表</button>\n  <ul>\n    <li v-for="user in users" :key="user.id">\n      {{ user.name }}、{{ user.age }}\n    </li>\n  </ul>\n</template>\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("安装、导入、编写逻辑：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pnpm -F @it200/module2 add @it200/apis\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<script setup lang="ts">\nimport { UserApi } from "@it200/apis";\nimport { ref } from "vue";\nconst users = ref();\nconst getUserList = async () => {\n  const resp = await UserApi.getUsers();\n  users.value = resp;\n};\n<\/script>\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[n("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fwww.awesomescreenshot.com%2Fvideo%2F9976769%3Fkey%3Dbe6dffcf6e60e59ec5a601b34582e57b",title:"https://www.awesomescreenshot.com/video/9976769?key=be6dffcf6e60e59ec5a601b34582e57b",target:"_blank",rel:"noopener noreferrer"}},[s._v("www.awesomescreenshot.com/video/99767…"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a4a2552d096464aace2454703294c0b~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("h4",{attrs:{id:"使用mockend来mock数据"}},[s._v("使用"),n("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fmockend.com%2F",title:"https://mockend.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Mockend"),n("OutboundLink")],1),s._v("来Mock数据：")]),s._v(" "),n("ol",[n("li",[s._v("选择一个符合自己的方案：")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e7bd821b9804fb888d00fcf25f4f0bc~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("选择要安装到得公共项目仓库，Github组织不支持免费的（只为截个图）：")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af1cdddc316942e19e14975346dec5a3~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[s._v("在项目root目录新建"),n("code",[s._v(".mockend.json")]),s._v("文件：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "User": {\n    "name": {\n      "string": {}\n    },\n    "avatarUrl": {\n      "regexp": "https://i\\.pravatar\\.cc/150\\?u=[0-9]{5}"\n    },\n    "statusMessage": {\n      "string": [\n        "working from home",\n        "watching Netflix"\n      ]\n    },\n    "email": {\n      "regexp": "#[a-z]{5,10}@[a-z]{5}\\.[a-z]{2,3}"\n    },\n    "color": {\n      "regexp": "#[0-9A-F]{6}"\n    },\n    "age": {\n      "int": {\n        "min": 21,\n        "max": 100\n      }\n    },\n    "isPublic": {\n      "boolean": {}\n    }\n  }\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br")])]),n("ol",{attrs:{start:"4"}},[n("li",[s._v("通过 "),n("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fmockend.com%2FOSpoon%2Fdata-mock%2Fusers",title:"https://mockend.com/OSpoon/data-mock/users",target:"_blank",rel:"noopener noreferrer"}},[s._v("mockend.com/OSpoon/data…"),n("OutboundLink")],1),s._v(" 就可以获取到mock数据了；")]),s._v(" "),n("li",[s._v("更多配置请参考"),n("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdocs.mockend.com%2F",title:"https://docs.mockend.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("docs.mockend.com/"),n("OutboundLink")],1),s._v("。")])]),s._v(" "),n("h3",{attrs:{id:"开发-components-模块"}},[s._v("开发 Components 模块：")]),s._v(" "),n("h4",{attrs:{id:"开发card组件-并应用到module3项目中"}},[s._v("开发Card组件，并应用到module3项目中：")]),s._v(" "),n("h5",{attrs:{id:"使用pnpm-create-vue-3来创建项目模板-修改项目名称和版本号"}},[s._v("使用pnpm create vue@3来创建项目模板，修改项目名称和版本号：")]),s._v(" "),n("h5",{attrs:{id:"创建如下card组件目录结构"}},[s._v("创建如下card组件目录结构：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("components                   \n├─ card                      \n│  ├─ src                    \n│  │  ├─ card.scss           \n│  │  └─ index.vue           \n│  └─ index.ts         \n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h5",{attrs:{id:"组件模板及配置"}},[s._v("组件模板及配置：")]),s._v(" "),n("p",[s._v("组件名称通过defineComponent函数导入，在注册组件时读取使用")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<script lang="ts">\nimport { defineComponent } from "vue";\nexport default defineComponent({\n  name: "it-card",\n});\n<\/script>\n<script setup lang="ts">\nconst props = defineProps({\n  shadow: {\n    type: String,\n    default: "always",\n  },\n  bodyStyle: {\n    type: Object,\n    default: () => {\n      return { padding: "20px" };\n    },\n  },\n});\nconsole.log("[ props ] >", props);\n<\/script>\n\n<template>\n  <div class="it-card">\n    <div :class="`is-${shadow}-shadow`"></div>\n    <div class="it-card__body" :style="bodyStyle">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n\n<style lang="scss" scoped></style>\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("h5",{attrs:{id:"组件样式文件"}},[s._v("组件样式文件：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(".it-card {\n    border-radius: 4px;\n    border: 1px solid #ebeef5;\n    background-color: #fff;\n    overflow: hidden;\n    color: #303133;\n    transition: 0.3s;\n\n    .it-card__body {\n        padding: 20px;\n    }\n\n    .is-always-shadow {\n        box-shadow: 0 2px 12px 0 rgb(0 0 0 / 10%);\n    }\n\n    .is-hover-shadow:hover {\n        box-shadow: 0 2px 12px 0 rgb(0 0 0 / 10%);\n    }\n\n    .is-never-shadow {\n        box-shadow: none;\n    }\n}\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("h5",{attrs:{id:"组件安装插件"}},[s._v("组件安装插件：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import type { App } from "vue";\nimport Card from "./src/index.vue";\n\nexport default {\n  install(app: App) {\n    app.component(Card.name, Card);\n  },\n};\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h5",{attrs:{id:"在components项目中尝试使用card组件"}},[s._v("在Components项目中尝试使用Card组件：")]),s._v(" "),n("ol",[n("li",[s._v("导入组件相关配置并安装，"),n("code",[s._v("components\\src\\main.ts")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import Card from "./components/card/index";\nimport "./components/card/src/card.scss";\n\napp.use(Card);\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("在"),n("code",[s._v("App.vue")]),s._v("组件中使用：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('<template>\n  <it-card style="width: 235px" :body-style="{ padding: \'0px\' }">\n    <img\n      src="https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"\n      class="image"\n    />\n    <div style="padding: 14px">\n      <span>好吃的汉堡</span>\n      <div class="bottom">\n        <time class="time">"2022-05-03T16:21:26.010Z"</time>\n      </div>\n    </div>\n  </it-card>\n</template>\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/224cc078990f4271aad50d2669140222~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("h5",{attrs:{id:"准备导入组件的相关配置"}},[s._v("准备导入组件的相关配置：")]),s._v(" "),n("ol",[n("li",[s._v("配置统一导出文件：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import Card from "./src/components/card/index";\nexport default {\n  Card,\n};\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("修改"),n("code",[s._v("package.json")]),s._v("的"),n("code",[s._v("main")]),s._v("字段：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "main": "index.ts"\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h5",{attrs:{id:"安装、导入到module3"}},[s._v("安装、导入到module3：")]),s._v(" "),n("ol",[n("li",[s._v("安装"),n("code",[s._v("components")]),s._v("组件包：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pnpm -F @it200/module3 add @it200/components\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("导入"),n("code",[s._v("components")]),s._v("组件包：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('import Comps from "@it200/components";\nimport "@it200/components/src/components/card/src/card.scss";\n\napp.use(Comps.Card);\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[s._v("使用方式同在Components项目中验证一样，效果一样，就不再演示了。")])]),s._v(" "),n("h2",{attrs:{id:"扩展-changesets发布变更"}},[s._v("扩展（Changesets发布变更）：")]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"增加相关配置"}},[s._v("增加相关配置：")]),s._v(" "),n("ol",[n("li",[s._v("安装"),n("code",[s._v("changesets")]),s._v("到工作空间根目录：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pnpm add -Dw @changesets/cli\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[s._v("执行"),n("code",[s._v("changesets")]),s._v("初始化命令：")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pnpm changeset init\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"生成新的changesets"}},[s._v("生成新的changesets：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pnpm changeset\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("注意：第一次运行前请检查"),n("code",[s._v("git")]),s._v("分支名称和"),n("code",[s._v(".changeset\\config.json")]),s._v("中的"),n("code",[s._v("baseBranch")]),s._v("是否一致。")]),s._v(" "),n("h4",{attrs:{id:"生成示例"}},[s._v("生成示例：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("PS xxx> pnpm changeset\n🦋  Which packages would you like to include? · @it200/module3\n🦋  Which packages should have a major bump? · No items were selected\n🦋  Which packages should have a minor bump? · @it200/module3\n🦋  Please enter a summary for this change (this will be in the changelogs).\n🦋    (submit empty line to open external editor)\n🦋  Summary · 增加components模块的配置和使用\n🦋\n🦋  === Summary of changesets ===\n🦋  minor:  @it200/module3\n🦋\n🦋  Note: All dependents of these packages that will be incompatible with\n🦋  the new version will be patch bumped when this changeset is applied.\n🦋\n🦋  Is this your desired changeset? (Y/n) · true\n🦋  Changeset added! - you can now commit it\n🦋\n🦋  If you want to modify or expand on the changeset summary, you can find it here\n🦋  info D:\\daydayup\\my-workspace.changeset\\purple-dodos-check.md\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h3",{attrs:{id:"发布变更"}},[s._v("发布变更：")]),s._v(" "),n("p",[s._v("执行命令，会依据先前生成的变更集来在对应的"),n("code",[s._v("package")]),s._v("中的项目中生成对应的"),n("code",[s._v("CHANGELOG.md")]),s._v("并提高对应项目的"),n("code",[s._v("version")]),s._v("，版本提升还需遵守语义化版本规范要求：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pnpm changeset version\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2bd285b359c24cfb8e046d905680d674~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image",alt:""}})]),s._v(" "),n("p",[s._v("后续的步骤还需按项目的实际情况来考虑，这里将变更日志生成、版本号提升后就先告一段落了~")]),s._v(" "),n("h2",{attrs:{id:"总结"}},[s._v("总结：")]),s._v(" "),n("hr"),s._v(" "),n("p",[s._v("这里使用了工作空间的概念来实现了大项目的拆分工作，每一个单独的模块、项目都可以独立维护、测试、构建，同时在 pnpm 的 node_modules 管理模式下节约了磁盘空间并提升安装速度。在这里只是小试牛刀，更多的特性还没有体现出来，需要后续跟进学习。项目的拆分和搭建没有特别的约定要做的一模一样，符合实际情况的考虑就是最优。")]),s._v(" "),n("p",[s._v("我正在参与掘金技术社区创作者签约计划招募活动，"),n("a",{attrs:{href:"https://juejin.cn/post/7112770927082864653",title:"https://juejin.cn/post/7112770927082864653",target:"_blank",rel:"noopener noreferrer"}},[s._v("点击链接报名投稿"),n("OutboundLink")],1),s._v("。")])])}),[],!1,null,null,null);n.default=t.exports}}]);