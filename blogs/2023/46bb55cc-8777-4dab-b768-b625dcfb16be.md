---
title: LogicFlowè‡ªå®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹
date: '2023-01-02 21:05'
sidebar: 'auto'
categories:
 - LogicFlow
tags:
 - LogicFlow
---

:::tip
LogicFlow æ˜¯ä¸€æ¬¾æµç¨‹å›¾ç¼–è¾‘æ¡†æ¶ï¼Œæä¾›äº†ä¸€ç³»åˆ—æµç¨‹å›¾äº¤äº’ã€ç¼–è¾‘æ‰€å¿…éœ€çš„åŠŸèƒ½å’Œçµæ´»çš„èŠ‚ç‚¹è‡ªå®šä¹‰ã€æ’ä»¶ç­‰æ‹“å±•æœºåˆ¶ã€‚LogicFlowæ”¯æŒå‰ç«¯ç ”å‘è‡ªå®šä¹‰å¼€å‘å„ç§é€»è¾‘ç¼–æ’åœºæ™¯ï¼Œå¦‚æµç¨‹å›¾ã€ERå›¾ã€BPMNæµç¨‹ç­‰ã€‚åœ¨å·¥ä½œå®¡æ‰¹é…ç½®ã€æœºå™¨äººé€»è¾‘ç¼–æ’ã€æ— ä»£ç å¹³å°æµç¨‹é…ç½®éƒ½æœ‰è¾ƒå¥½çš„åº”ç”¨ã€‚
:::

<!-- more -->

> ğŸ„Hi~ å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°é‘«åŒå­¦ï¼Œä¸€ä½é•¿æœŸä»äº‹å‰ç«¯å¼€å‘çš„ç¼–ç¨‹çˆ±å¥½è€…ï¼Œæˆ‘å°†ä½¿ç”¨æ›´ä¸ºå®ç”¨çš„æ¡ˆä¾‹è¾“å‡ºæ›´å¤šçš„ç¼–ç¨‹çŸ¥è¯†ï¼ŒåŒæ—¶æˆ‘ä¿¡å¥‰åˆ†äº«æ˜¯æˆé•¿çš„å”¯ä¸€æ·å¾„ï¼Œåœ¨è¿™é‡Œä¹Ÿå¸Œæœ›æˆ‘çš„æ¯ä¸€ç¯‡æ–‡ç« éƒ½èƒ½æˆä¸ºä½ æŠ€æœ¯è½åœ°çš„å‚è€ƒ~


## 1. å‡†å¤‡å·¥ä½œ
### 1. åˆå§‹åŒ–é¡¹ç›®ï¼š
#### 1.1 åˆå§‹åŒ–ç¯å¢ƒï¼š
> ä½¿ç”¨`pnpm create vite`åˆ›å»ºé¡¹ç›®ï¼Œé€‰æ‹©`Vue`æ¡†æ¶åŠ`TypeScript`å˜ä½“ï¼›

#### 1.2 å®‰è£…æ ¸å¿ƒæ¨¡å—ï¼š
> å®‰è£…æ ¸å¿ƒæ¨¡å—ï¼š`pnpm add @logicflow/core`ï¼›

### 2. åˆå§‹åŒ–å®¹å™¨åŠLogicFlowå¯¹è±¡ï¼š
#### 2.1 å‡†å¤‡å®¹å™¨ï¼š
> å‡†å¤‡ä¸€ä¸ª`container`å®¹å™¨ï¼Œå¹¶é€šè¿‡**css**åˆå§‹åŒ–å®¹å™¨çš„å°ºå¯¸ï¼›

```typescript
<template>
  <div ref="container" class="container"></div>
</template>

<style scoped>
.container {
  width: 500px;
  height: 400px;
}
</style>

```
#### 2.2 å¯¼å…¥æ¨¡å—ï¼š
> å¯¼å…¥`LogicFlow`å’Œå¯¹åº”çš„æ ·å¼ä¾èµ–æ¨¡å—ï¼›

```typescript
<script setup lang="ts">
import LogicFlow from "@logicflow/core";
import "@logicflow/core/dist/style/index.css";
</script>
```
#### 2.3 å®ä¾‹åŒ–&æ¸²æŸ“ï¼š
> åœ¨`onMounted`åå¯¹`LogicFlow`å¯¹è±¡å®ä¾‹åŒ–å¹¶è¿›è¡Œæ¸²æŸ“ï¼Œä¸ºäº†èƒ½çœ‹åˆ°åˆå§‹å®¹å™¨å»ºè®®å¼€å¯`grid`é€‰é¡¹ï¼›

```typescript
<script setup lang="ts">
import { onMounted, ref } from "vue";

const container = ref();
const lf = ref<LogicFlow>();

onMounted(() => {
  lf.value = new LogicFlow({
    container: container.value,
    grid: true,
  })
  lf.value.render();
})
</script>
```
#### 2.4 é¢„è§ˆæ•ˆæœï¼š
> å¯åŠ¨é¡¹ç›®ååœ¨æµè§ˆå™¨è®¿é—®å³å¯çœ‹åˆ°è¿™ä¸ª`500*400`çš„ç‚¹é˜µå›¾ï¼Œè¿™ä¸ªå°±æ˜¯åé¢ç»˜åˆ¶èŠ‚ç‚¹çš„åŒºåŸŸï¼›

![image.png](https://img-blog.csdnimg.cn/img_convert/ce9dafc549904431318325eedc8523ff.png)
## 2. è‡ªå®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹ï¼š
### 2.1 å‡†å¤‡è‡ªå®šä¹‰æ¨¡æ¿ï¼š
> å‡†å¤‡è‡ªå®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹æ¨¡æ¿ï¼Œåˆ†åˆ«ç»§æ‰¿`RectNode`å’Œ`RectNodeModel`å¹¶å¯¼å‡º`type`ã€`view`å’Œ`model`ä¸‰ä¸ªé€‰é¡¹ï¼š

```typescript
import { RectNode, RectNodeModel } from "@logicflow/core";

class CustomNodeView extends RectNode {

}

class CustomNodeModel extends RectNodeModel {

}

export default {
    type: "CustomNode",
    view: CustomNodeView,
    model: CustomNodeModel,
}
```
### 2.2 ä¼˜å…ˆæ³¨å†Œ&ä½¿ç”¨ï¼š
> ä¼˜å…ˆè¿›è¡Œæ³¨å†Œå¹¶å®šä¹‰æ•°æ®ï¼Œæ–¹ä¾¿è‡ªå®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹å®æ—¶é¢„è§ˆï¼›

```typescript
<script setup lang="ts">
// å¯¼å…¥è‡ªå®šä¹‰èŠ‚ç‚¹
import CustomNode from "./nodes/CustomNode";

// å®šä¹‰graphData
// æ•°æ®ä¸­çš„typeä¸ºè‡ªå®šä¹‰èŠ‚ç‚¹å¯¼å‡ºçš„typeå±æ€§çš„å€¼
// å°†èŠ‚ç‚¹åœ¨åæ ‡ä¸ºï¼ˆ100,100ï¼‰çš„ä½ç½®æ˜¾ç¤º
const graphData = {
  nodes: [
    {
      id: 'fba7fc7b-83a8-4edd-b4be-21f694a5d490',
      type: 'CustomNode',
      x: 100,
      y: 100
    }
  ]
}

onMounted(() => {
  // åœ¨æ‰§è¡Œrenderå‰è¿›è¡Œæ³¨å†Œ
  lf.value.register(CustomNode);
  lf.value.render(graphData);
})
</script>
```
**tip**ï¼šæ­¤æ—¶çš„å®¹å™¨æ­£å¸¸æƒ…å†µä¸‹å°±å·²ç»æ¸²æŸ“å‡º`100*80`çš„çŸ©å½¢èŠ‚ç‚¹äº†ï¼›
### 2.3 è‡ªå®šä¹‰æ ·å¼ï¼š
> è‡ªå®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹çš„æ ·å¼ï¼ˆ**ç»¿è‰²æè¾¹**ï¼‰ï¼Œéœ€è¦é‡å†™`RectNodeModel`ç±»ä¸­çš„`getNodeStyle()`å‡½æ•°ï¼›

```typescript
getNodeStyle() {
  const style = super.getNodeStyle();
  style.stroke = 'green';
  return style;
}
```
**tip**ï¼šæ­¤æ—¶çš„çŸ©å½¢çš„è¾¹æ¡†å°†å˜æˆç»¿è‰²ï¼›
![image.png](https://img-blog.csdnimg.cn/img_convert/88b6e4ca80fdf9876be5182c4926e89a.png)
### 2.4 è‡ªå®šä¹‰å½¢çŠ¶ï¼š
> è‡ªå®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹çš„å½¢çŠ¶ï¼ˆåœ†è§’çŸ©å½¢ï¼‰ï¼Œéœ€è¦é‡å†™`RectNodeModel`ç±»ä¸­çš„`initNodeData(data: any)`å‡½æ•°ï¼›

```typescript
initNodeData(data: any): void {
  super.initNodeData(data);
  this.width = 120;
  this.height = 80;
  this.radius = 10;
}
```
**tip**ï¼šæ­¤æ—¶çš„çŸ©å½¢å°†è·å¾—åœ†è§’å¹¶ä¸”é»˜è®¤çš„å°ºå¯¸å°†å˜æˆ`120*80`ï¼›
![image.png](https://img-blog.csdnimg.cn/img_convert/5070ab885ee1cac55a998a25d8b92752.png)
### 2.5 è‡ªå®šä¹‰å¤–è§‚ï¼š
> è‡ªå®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹çš„å¤–è§‚å¯ä»¥å®ç°æ›´åŠ ä¸ªæ€§åŒ–çš„æ˜¾ç¤ºæ•ˆæœï¼Œå¯ä»¥é€šè¿‡é‡å†™`RectNode`ç±»ä¸­çš„`getShape()`å¹¶å€ŸåŠ©`LogicFlow`æä¾›çš„`h`å‡½æ•°æ¥å®ç°ä¸ªæ€§åŒ–æ•ˆæœçš„æ¸²æŸ“ï¼›

1. ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨`h`å‡½æ•°æ¸²æŸ“é‡å†™`getShape`å‰çš„å¤–è§‚ï¼›`rect`çš„åŸç‚¹ä¸`graphData`åŸç‚¹éåŒä¸€ä¸ªç‚¹ï¼Œéœ€è¦è½¬æ¢ï¼›
```typescript
getShape() {
    // è·å–XxxNodeModelä¸­å®šä¹‰çš„å½¢çŠ¶å±æ€§
    const { model } = this.props;
    const { x, y, width, height, radius } = model;
    // è·å–XxxNodeModelä¸­å®šä¹‰çš„æ ·å¼å±æ€§
    const style = model.getNodeStyle();

    return h('g', {}, [
        h('rect', {
            ...style,
            x: x - width / 2,
            y: y - height / 2,
            width,
            height,
            rx: radius,
            ry: radius,
        })
    ]);
}
```

2. åœ¨ç°åœ¨çŸ©å½¢èŠ‚ç‚¹çš„å·¦ä¸Šè§’å¢åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„`Icon`ï¼Œå¯ä»¥åœ¨`iconfont`æ‰¾ä¸€ä¸ªå–œæ¬¢çš„Iconï¼Œå¹¶æ‹·è´å…¶`SVG`æ•°æ®ï¼Œå†é€šè¿‡`h`å‡½æ•°é‡å†™å¹¶æ¸²æŸ“ï¼›
```typescript
h('svg', {
    x: x - width / 2 + 5,
    y: y - height / 2 + 5,
    width: 25,
    height: 25,
    viewBox: "0 0 1028 1024",
}, [
    h('path', {
        fill: style.stroke,
        d: "M20.6692 180.672c-27.104 27.136-21.312 65.344 0.256 86.88 0.864 0.832 87.488 83.584 209.312 205.408 3.136 3.136 7.232 4.672 11.328 4.672s8.192-1.568 11.328-4.672c6.24-6.24 6.24-16.384 0-22.624-18.368-18.368-35.84-35.744-52.416-52.192l50.848-50.848c6.24-6.24 6.24-16.384 0-22.624s-16.384-6.24-22.624 0l-50.976 50.976c-28.512-28.16-53.632-52.736-74.08-72.672l115.68-115.68c6.24-6.24 6.24-16.384 0-22.624s-16.384-6.24-22.624 0l-116.032 116.032c-23.552-22.816-37.12-35.776-37.344-36-6.752-6.752-15.616-25.76 0-41.376l160-160c6.176-6.272 22.624-18.72 40.672-0.768 0.8 0.896 81.6 92.672 204.928 216 6.24 6.24 16.384 6.24 22.624 0s6.24-16.384 0-22.624c-122.56-122.528-202.752-213.6-204.224-215.264-29.824-29.76-65.792-20.832-86.624 0l-160.032 160zM699.3252 772.672c-6.24-6.24-16.384-6.24-22.624 0l-50.912 50.88c-15.52-15.712-31.808-32.16-48.96-49.312-6.24-6.24-16.384-6.24-22.624 0s-6.24 16.384 0 22.624c118.528 118.496 201.312 207.008 202.496 208.288 10.976 11.008 26.016 17.056 42.336 17.056l0 0c16.8 0 33.792-6.56 44.32-17.12l159.936-161.824c20.128-20.128 21.28-54.272 2.496-73.12l-214.592-214.56c-6.24-6.24-16.384-6.24-22.624 0s-6.24 16.384 0 22.624l214.592 214.56c6.4 6.4 5.184 20.224-2.528 27.936l-159.968 161.824c-3.68 3.712-12.032 7.68-21.632 7.68 0 0 0 0 0 0-5.504 0-13.376-1.344-19.328-7.328-0.32-0.352-13.728-14.656-36.992-39.008l116.608-116.608c6.24-6.24 6.24-16.384 0-22.624s-16.384-6.24-22.624 0l-116.128 116.128c-19.968-20.768-44.448-46.016-72.32-74.432l51.072-51.072c6.24-6.208 6.24-16.32 0-22.592zM4.5412 1018.528c3.072 3.136 7.2 4.8 11.456 4.8 1.536 0 3.072-0.224 4.576-0.672l320-95.328c2.592-0.768 4.896-2.144 6.784-4.064l546.88-550.56c0.768-0.768 1.152-1.76 1.728-2.624l116.992-116.992c9.408-9.44 14.624-21.952 14.624-35.296s-5.216-25.824-14.624-35.2l-167.52-167.488c-18.816-18.816-51.68-18.816-70.496 0l-119.648 119.648c-0.768 0.768-1.184 1.76-1.76 2.656l-547.712 547.744c-1.792 1.792-3.136 3.968-3.904 6.368l-101.12 310.88c-1.856 5.664-0.416 11.84 3.744 16.128zM667.5172 168.672l33.248 33.248-496.736 498.08-55.264-12.544 518.752-518.784zM223.9972 725.312l499.424-500.736 77.952 77.952-503.936 497.472-73.44 0 0-74.688zM860.2852 361.472l-519.808 523.328-18.464-64.064 501.984-495.584 36.288 36.32zM127.7732 715.488l64.224 14.592 0 85.92c0 8.832 7.168 16 16 16l83.968 0 20.288 70.4-271.616 80.928 87.136-267.84zM797.5972 37.728c6.752-6.752 18.496-6.752 25.248 0l167.52 167.52c3.36 3.36 5.216 7.84 5.216 12.608 0 4.736-1.856 9.248-5.248 12.64l-107.872 107.904-192.736-192.736 107.872-107.936z",
    })
])
```
### 2.6 æœ€ç»ˆé¢„è§ˆï¼š
è‡³æ­¤è¿™ä¸ªæ–°çš„è‡ªå®šä¹‰ä¸šåŠ¡èŠ‚ç‚¹å°±å®Œæˆäº†ï¼Œè¿™ç§é£æ ¼çš„ä¸šåŠ¡èŠ‚ç‚¹ä¹Ÿæ˜¯å¤§å¤šæ•°æµç¨‹ç®¡ç†ç³»ç»Ÿä¸­å¸¸è§çš„é£æ ¼ï¼›æ¥ç€è¡¥å……ä¸€ä¸‹`graphData`æ•°æ®ï¼Œæ¥çœ‹ä¸€ä¸‹æœ€ç»ˆæ•ˆæœ~
```typescript
const graphData = {
  nodes: [
    {
      id: 'fba7fc7b-83a8-4edd-b4be-21f694a5d490',
      type: 'CustomNode',
      x: 100,
      y: 100
    },
    {
      id: '681035e6-11e3-43d7-9392-1deed852c01a',
      type: 'CustomNode',
      x: 300,
      y: 100
    }
  ],
  edges: [
    {
      sourceNodeId: 'fba7fc7b-83a8-4edd-b4be-21f694a5d490',
      targetNodeId: '681035e6-11e3-43d7-9392-1deed852c01a',
      type: 'polyline'
    }
  ]
}
```
![image.png](https://img-blog.csdnimg.cn/img_convert/51d08032d40c16ee8e9d6d8360d6666e.png)

---

**å¦‚æœçœ‹å®Œè§‰å¾—æœ‰æ”¶è·ï¼Œæ¬¢è¿ç‚¹èµã€è¯„è®ºã€åˆ†äº«æ”¯æŒä¸€ä¸‹ã€‚ä½ çš„æ”¯æŒå’Œè‚¯å®šï¼Œæ˜¯æˆ‘åšæŒå†™ä½œçš„åŠ¨åŠ›~**
