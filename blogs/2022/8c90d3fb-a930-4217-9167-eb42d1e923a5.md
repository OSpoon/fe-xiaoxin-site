---
title: åœ¨çº¿æ–‡æ¡£é¢„è§ˆæœåŠ¡
date: '2022-12-15 14:08'
sidebar: 'auto'
categories:
 - æ–‡æ¡£é¢„è§ˆ
tags:
 - 
---

:::tip
åˆ©ç”¨å¼€æºä¸–ç•Œçš„äº§å“å®ç°H5åœ¨çº¿é¢„è§ˆæ–‡æ¡£åŠŸèƒ½ï¼Œåœ¨ä¸èŠ±é’±çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸€å®šæ˜¯æœ€ä¼˜çš„è§£å†³æ–¹æ¡ˆ
:::


<!-- more -->

> å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯[å°é‘«åŒå­¦](https://it200.cn/)ã€‚ä¸€ä½é•¿æœŸä»äº‹**å‰ç«¯å¼€å‘**çš„ç¼–ç¨‹çˆ±å¥½è€…ï¼Œ**æˆ‘ä¿¡å¥‰ç¼–ç¨‹æœ€é‡è¦çš„æ˜¯åˆ†äº«**ã€‚è¯·è·Ÿéšå°é‘«åŒå­¦çš„æ­¥ä¼ï¼Œä¸€èµ·å¸¦ä½ ç•…æ¸¸ä¸ä¸€æ ·çš„å‰ç«¯ä¸–ç•Œ~

## æœ¬åœ°æºç å¯åŠ¨ï¼š
### 1. å®‰è£…å¿…è¦çš„å·¥å…·åŠå¥—ä»¶ï¼š

1. å®‰è£… IDEA å¼€å‘å·¥å…·ï¼š[https://www.jetbrains.com/idea/](https://www.jetbrains.com/idea/)ï¼›
2. å®‰è£… Java1.8+ ç¯å¢ƒä¾èµ–ï¼š[https://www.oracle.com/java/technologies/downloads/#java8](https://www.oracle.com/java/technologies/downloads/#java8)ï¼›
3. å®‰è£… OpenOffice å¥—ä»¶ï¼š[http://www.openoffice.org/download/](http://www.openoffice.org/download/)ï¼›
4. å®‰è£… LibreOffice å¥—ä»¶ï¼š[https://zh-cn.libreoffice.org/](https://zh-cn.libreoffice.org/)ï¼›

PSï¼šOpenOffice å’Œ LibreOffice å¿…é¡»å®‰è£…å…¶ä¸­ä¸€é¡¹ï¼›
### 2. æœ¬åœ°éƒ¨ç½²æºç ï¼š
```shell
git clone git@gitee.com:kekingcn/file-online-preview.git
```
### 3. è°ƒæ•´Officeè·¯å¾„ï¼š
é…ç½®æ–‡ä»¶ï¼š`file-online-preview-master\server\src\main\config\application.properties`
```shell
#openoffice homeè·¯å¾„
office.home = C:\\Program Files (x86)\\OpenOffice 4
#office.home = C:\\Program Files\\LibreOffice
#office.home = ${KK_OFFICE_HOME:default}
```
### 4. æ°´å°è®¾ç½®ï¼š
é…ç½®æ–‡ä»¶ï¼š`file-online-preview-master\server\src\main\config\application.properties`
```shell
#æ°´å°å†…å®¹
#ä¾‹ï¼šwatermark.txt = ${WATERMARK_TXT:å‡¯äº¬ç§‘æŠ€å†…éƒ¨æ–‡ä»¶ï¼Œä¸¥ç¦å¤–æ³„}
#å¦‚éœ€å–æ¶ˆæ°´å°ï¼Œå†…å®¹è®¾ç½®ä¸ºç©ºå³å¯ï¼Œä¾‹ï¼šwatermark.txt = ${WATERMARK_TXT:}
watermark.txt = ${WATERMARK_TXT:å°é‘«åŒå­¦åœ¨çº¿}
#æ°´å°xè½´é—´éš”
watermark.x.space = ${WATERMARK_X_SPACE:100}
#æ°´å°yè½´é—´éš”
watermark.y.space = ${WATERMARK_Y_SPACE:100}
#æ°´å°å­—ä½“å¤§å°
watermark.fontsize = ${WATERMARK_FONTSIZE:18px}
#æ°´å°é€æ˜åº¦ï¼Œè¦æ±‚è®¾ç½®åœ¨å¤§äºç­‰äº0.005ï¼Œå°äº1
watermark.alpha = ${WATERMARK_ALPHA:0.1}
#æ°´å°å€¾æ–œåº¦æ•°ï¼Œè¦æ±‚è®¾ç½®åœ¨å¤§äºç­‰äº0ï¼Œå°äº90
watermark.angle = ${WATERMARK_ANGLE:30}
```
## æœåŠ¡å™¨éƒ¨ç½²ï¼š
### 1. å®‰è£…è¿œç¨‹è¿æ¥å·¥å…·ï¼š
å®‰è£…[FinalShell](http://www.hostbuf.com/)å·¥å…·åä»¥æ­¤æ·»åŠ ä¸»æœºIPã€ç”¨æˆ·åã€å¯†ç ç­‰è¿æ¥ä¿¡æ¯ã€‚
![image.png](https://cdn.nlark.com/yuque/0/2022/png/2373519/1671083220221-2a11e4df-27e3-4f62-a942-0623d03c4a6a.png#averageHue=%23e5c383&clientId=uedade3fd-a8f1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=881&id=u7938b00f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=881&originWidth=1166&originalType=binary&ratio=1&rotation=0&showTitle=false&size=483397&status=done&style=none&taskId=u5256a506-69e2-449b-898b-e6dd2adf85e&title=&width=1166)
### 2. Officeå¥—ä»¶å®‰è£…ï¼š
æ–°çš„ç¯å¢ƒå¤§æ¦‚ç‡æ˜¯æ²¡æœ‰ç›¸å…³çš„**Office**å¥—ä»¶çš„ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨[kkFileView for install.sh](https://gitee.com/kekingcn/file-online-preview/blob/master/server/src/main/bin/install.sh)æ¥è¿›è¡Œå®‰è£…ï¼Œå°†è„šæœ¬çš„å®Œæ•´å†…å®¹æ‹·è´è‡³**FinalShell**ç»ˆç«¯ã€‚
```shell
#!/bin/bash
cd /tmp

install_redhat() {
   wget https://kkfileview.keking.cn/LibreOffice_7.3.7_Linux_x86-64_rpm.tar.gz -cO LibreOffice_7_rpm.tar.gz && tar -zxf /tmp/LibreOffice_7_rpm.tar.gz && cd /tmp/LibreOffice_7.3.7.2_Linux_x86-64_rpm/RPMS
   echo $?
   if [ $? -eq 0 ];then
     yum install -y libSM.x86_64 libXrender.x86_64  libXext.x86_64
     yum groupinstall -y  "X Window System"
     yum localinstall -y *.rpm
     echo 'install finshed...'
   else
     echo 'download package error...'
   fi
}

install_ubuntu() {
   wget  https://kkfileview.keking.cn/LibreOffice_7.3.7_Linux_x86-64_deb.tar.gz  -cO LibreOffice_7_deb.tar.gz && tar -zxf /tmp/LibreOffice_7_deb.tar.gz && cd /tmp/LibreOffice_7.3.7.2_Linux_x86-64_deb/DEBS
   echo $?
 if [ $? -eq 0 ];then
     apt-get install -y libxinerama1 libcairo2 libcups2 libx11-xcb1
     dpkg -i *.deb
     echo 'install finshed...'
  else
    echo 'download package error...'
 fi
}


if [ -f "/etc/redhat-release" ]; then
  yum install -y wget
  install_redhat
else
  apt-get install -y wget
  install_ubuntu
fi
```
æ³¨æ„ï¼šä¸‹è½½åå¦‚æœå‘ç°ä¸ºèƒ½æˆåŠŸå®‰è£…ï¼Œå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ï¼š`yum -y localinstall *.rpm`ï¼›
### 3. åˆ©ç”¨ docker éƒ¨ç½²ï¼š

1. dockeréƒ¨ç½²å¦‚é‡åˆ° **driver failed programming external connectivity on endpoint xxx**ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡æ˜¯ç”±äºä¸é˜²ç«å¢™å†²çªå¯¼è‡´ï¼Œå»ºè®®é‡å¯dockerï¼š`systemctl restart docker`ï¼›
2. æ­£å¸¸æƒ…å†µä¸‹è¿˜éœ€è¦åœ¨é˜¿é‡Œäº‘å¯¹ç«¯å£è¿›è¡Œæ”¾è¡Œï¼Œå¦‚æœæœ‰ä½¿ç”¨åˆ°å®å¡”é¢æ¿ï¼ŒåŒæ ·éœ€è¦åœ¨å®å¡”é¢æ¿è¿›è¡Œç«¯å£æ”¾å¿ƒï¼›
```
// æ‹‰å–é•œåƒ
docker pull keking/kkfileview:4.1.0
// å¯åŠ¨é•œåƒ
docker run -it -p 8012:8012 keking/kkfileview:4.1.0
```
![image.png](https://cdn.nlark.com/yuque/0/2022/png/2373519/1671083731819-04260b32-3e6c-49b5-8166-48355fb13131.png#averageHue=%2374d497&clientId=uedade3fd-a8f1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=881&id=u9cf0fc15&margin=%5Bobject%20Object%5D&name=image.png&originHeight=881&originWidth=1166&originalType=binary&ratio=1&rotation=0&showTitle=false&size=796571&status=done&style=none&taskId=u27f87b87-2fd2-4fa8-b744-f116385ce4b&title=&width=1166)
![image.png](https://cdn.nlark.com/yuque/0/2022/png/2373519/1671083749661-2c0ec721-25f0-4588-aaf0-41145c622f20.png#averageHue=%23eae9e9&clientId=uedade3fd-a8f1-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=758&id=ufd89be4d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=758&originWidth=1708&originalType=binary&ratio=1&rotation=0&showTitle=false&size=75183&status=done&style=none&taskId=ud28f7536-461e-4bf3-a77d-a97ae829d92&title=&width=1708)

---

* * *

**å¦‚æœçœ‹å®Œè§‰å¾—æœ‰æ”¶è·ï¼Œæ¬¢è¿ç‚¹èµã€è¯„è®ºã€åˆ†äº«æ”¯æŒä¸€ä¸‹ã€‚ä½ çš„æ”¯æŒå’Œè‚¯å®šï¼Œæ˜¯æˆ‘åšæŒå†™ä½œçš„åŠ¨åŠ›~**
æœ€åå¯ä»¥å…³æ³¨æˆ‘@å°é‘«åŒå­¦ã€‚æ¬¢è¿[ç‚¹æ­¤æ‰«ç åŠ æˆ‘](https://it200.cn/)äº¤æµï¼Œå…±åŒè¿›æ­¥ï¼ˆè¿˜å¯ä»¥å¸®ä½ **fix**ğŸ›ï¼‰~