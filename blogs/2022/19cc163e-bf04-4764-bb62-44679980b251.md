---
title: æä¸€ææ˜ç™½Vitepressçš„æ–‡æ¡£æ¸²æŸ“åŸºç¡€
date: '2022-10-21 21:12'
sidebar: 'auto'
categories:
 - Vitepress
tags:
 - Vitepress
---

:::tip
**Vitepress**çš„æ–‡æ¡£æ¸²æŸ“ç›®çš„å°±æ˜¯å°†ç¨‹åºå‘˜æ—¥å¸¸æ‰€å†™çš„**Markdown**æ–‡ä»¶ç¼–è¯‘ä¸º**Html**æ–‡ä»¶ï¼Œå¹¶æ·»åŠ äº†æ›´å¤šçš„æ’ä»¶æ¥ä¸°å¯Œ**MD**æ–‡ä»¶çš„åŠŸèƒ½ï¼Œå°±æ¯”å¦‚è¯´**Vuejs**ç»„ä»¶åœ¨**MD**æ–‡ä»¶ä¸­æ¸²æŸ“ç­‰ç­‰ï¼Œä¸ºäº†æˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨**Vitepress**çš„æ—¶å€™å¯ä»¥æ›´éšå¿ƒæ‰€æ¬²çš„å®šåˆ¶ä¸€äº›åŠŸèƒ½ï¼Œæˆ‘ä»¬è¦å…ˆæä¸€ææ˜ç™½**Vitepress**æ˜¯å¦‚ä½•å°†**MD**æ–‡æ¡£æ¸²æŸ“æˆ**HTML**çš„~
:::

<!-- more -->

## 1. å‰è¨€
------

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯[å°é‘«åŒå­¦](https://it200.cn/ "https://it200.cn/")ã€‚ä¸€ä½ä»äº‹è¿‡**Androidå¼€å‘**ã€**æ··åˆå¼€å‘**ï¼Œç°åœ¨é•¿æœŸä»äº‹**å‰ç«¯å¼€å‘**çš„ç¼–ç¨‹çˆ±å¥½è€…ï¼Œ**æˆ‘è§‰å¾—åœ¨ç¼–ç¨‹ä¹‹è·¯ä¸Šæœ€é‡è¦çš„æ˜¯çŸ¥è¯†çš„åˆ†äº«ï¼Œæ‰€è°“ä¸‰äººè¡Œå¿…æœ‰æˆ‘å¸ˆ**ã€‚æ‰€ä»¥æˆ‘å¼€å§‹åœ¨ç¤¾åŒºæŒç»­è¾“å‡ºæˆ‘æ‰€äº†è§£åˆ°ã€å­¦ä¹ åˆ°ã€å·¥ä½œä¸­é‡åˆ°çš„å„ç§ç¼–ç¨‹çŸ¥è¯†ï¼Œæ¬¢è¿æœ‰æƒ³æ³•ã€æœ‰åŒæ„Ÿçš„ä¼™ä¼´åŠ æˆ‘[fe-xiaoxin](https://it200.cn/ "https://it200.cn/")å¾®ä¿¡äº¤æµ~

**Vitepress**çš„æ–‡æ¡£æ¸²æŸ“ç›®çš„å°±æ˜¯å°†ç¨‹åºå‘˜æ—¥å¸¸æ‰€å†™çš„**Markdown**æ–‡ä»¶ç¼–è¯‘ä¸º**Html**æ–‡ä»¶ï¼Œå¹¶æ·»åŠ äº†æ›´å¤šçš„æ’ä»¶æ¥ä¸°å¯Œ**MD**æ–‡ä»¶çš„åŠŸèƒ½ï¼Œå°±æ¯”å¦‚è¯´**Vuejs**ç»„ä»¶åœ¨**MD**æ–‡ä»¶ä¸­æ¸²æŸ“ç­‰ç­‰ï¼Œä¸ºäº†æˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨**Vitepress**çš„æ—¶å€™å¯ä»¥æ›´éšå¿ƒæ‰€æ¬²çš„å®šåˆ¶ä¸€äº›åŠŸèƒ½ï¼Œæˆ‘ä»¬è¦å…ˆæä¸€ææ˜ç™½**Vitepress**æ˜¯å¦‚ä½•å°†**MD**æ–‡æ¡£æ¸²æŸ“æˆ**HTML**çš„~

### çœ‹å®Œå¯ä»¥æ˜ç™½è¿™3ç‚¹ï¼Ÿ

- [x] MDæ–‡æ¡£è½¬HTMLæ–‡æ¡£æµç¨‹ï¼›
- [x] å¦‚ä½•æ”¯æŒä»£ç å—é«˜äº®ï¼›
- [x] å¦‚ä½•å®ç°è‡ªå®šä¹‰å®¹å™¨ï¼›

![image.png](https://cdn.nlark.com/yuque/0/2022/png/2373519/1666018932341-01fdb45f-3fe0-4583-b986-2d279f28dedc.png#clientId=ue457beec-ce64-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=745&id=u9bed4834&margin=%5Bobject%20Object%5D&name=image.png&originHeight=745&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&size=318581&status=done&style=stroke&taskId=uc6c89db4-f51d-4d59-b2e9-d0e7857c990&title=&width=1220)
[æ¼”ç¤ºåœ°å€](https://www.awesomescreenshot.com/video/11781022?key=2451152c019ed7ecb5aa1dcacff7bd4b)
## 2. å®ç°MDæ–‡æ¡£è½¬HTMLæ–‡æ¡£
### 2.1 è¯·æŒ‰å¦‚ä¸‹é¡¹ç›®ç»“æ„å‡†å¤‡æˆ‘ä»¬çš„å®éªŒç¯å¢ƒ~
```
â”œâ”€markdown-it-demo
â”‚  â”œâ”€src
â”‚  â”‚  â”œâ”€index.ts
â”‚  â”‚  â”œâ”€temp.md
â”‚  â”œâ”€index.html
â””â”€ â””â”€package.json
```
### 2.2 åˆ©ç”¨markdown-itæ¨¡å—å®ç°æ–‡æ¡£è½¬æ¢ï¼š
> markdown-it æ˜¯ç›®å‰æ¯”è¾ƒé€šç”¨çš„MDè¯­æ³•è§£ææ¨¡å—ï¼Œå¿«é€Ÿä¸”æ˜“äºæ‰©å±•ï¼Œéµå¾ªCOmmonMarkè§„èŒƒï¼Œä¸”æœ‰å¤§é‡çš„ç¤¾åŒºæ’ä»¶~

1. æ‰§è¡Œå®‰è£…æ¨¡å—å‘½ä»¤ï¼š`pnpm i markdown-it @types/markdown-it -D`ï¼›
2. å¯¼å…¥`markdown-it`æ¨¡å—å¹¶å®ä¾‹åŒ–**md**å¯¹è±¡ï¼›
```typescript
import markdownIt from "markdown-it";

// å®ä¾‹åŒ–md-itå¯¹è±¡
const md = new markdownIt();
```

3. é€šè¿‡`fs-extra`æ¨¡å—è¯»å–æ”¾ç½®åœ¨`src`ä¸‹çš„`temp.md`æ–‡ä»¶ï¼Œè¯»å–åçš„**Buffer**æ•°ç»„é€šè¿‡`toString()`è½¬ä¸ºå­—ç¬¦ä¸²ï¼›
```typescript
const rawMd = fs.readFileSync(path.resolve(__dirname, "temp.md")).toString();
```

4. åˆ©ç”¨**md**å¯¹è±¡çš„`render`å‡½æ•°æ¥è®²`rawMd`è¿›è¡Œè½¬æ¢ï¼›
```typescript
const output = md.render(rawMd);
```

5. è½¬æ¢å®Œæˆåå°†`output`å†…å®¹è¾“å‡ºåˆ°`index.html`æ–‡ä»¶ä¸­ï¼›
```typescript
fs.writeFileSync(path.resolve(__dirname, "../index.html"), `
${output}
`);
```

6. åœ¨è½¬æ¢å®Œæˆåå¯ä»¥åˆ©ç”¨`child_process.exec(root-path)`è‡ªåŠ¨åœ¨æµè§ˆå™¨æ‰“å¼€index.htmlæ–‡æ¡£ï¼›
## 3. å®ç°MDæ”¯æŒä»£ç å—é«˜äº®
> ä»£ç å—é«˜äº®æ‰€ä½¿ç”¨çš„æ¨¡å—æ—¶**highlight.js**ï¼Œè¯¥æ¨¡å—åŒæ—¶å†…ç½®äº†å¾ˆå¤šå¸¸è§çš„ä»£ç å—æ ·å¼æ–‡ä»¶å¯ä¾›é€‰æ‹©~

### 3.1 ç¬¬ä¸€æ­¥æ”¹é€ markdownItå¯¹è±¡çš„æ„é€ å‡½æ•°ï¼š
`highlight`å±æ€§é…ç½®çš„å‡½æ•°ä¼ å…¥**codeç‰‡æ®µ**å’Œ**ä»£ç æ–¹è¨€**ä¸¤éƒ¨åˆ†ï¼Œé€šè¿‡åœ¨**hljs**åº“ä¸­æŸ¥æ‰¾å¯¹åº”çš„**æ–¹è¨€**æ¥åˆ©ç”¨**hljs**åº“å®ç°ä»£ç çš„å¿«é€Ÿé«˜äº®ï¼Œå½“æ— æ³•æŸ¥æ‰¾åˆ°å¯¹åº”çš„**æ–¹è¨€**æ—¶å°†è¿”å›ä»…ä»…è½¬ä¹‰åçš„**html**ç‰‡æ®µ~
```typescript
const md = new markdownIt({
    highlight: (str: string, lang: string) => {
        const defaultCode: string = `<pre class="hljs"><code>${md.utils.escapeHtml(str)}</code></pre>`;
        if (lang && hljs.getLanguage(lang)) {
            try {
                return `<pre class="hljs"><code>${hljs.highlight(str, { language: lang, ignoreIllegals: true }).value}</code></pre>`
            } catch (__) {
                return defaultCode;
            }
        }
        return defaultCode;
    }
});
```
### 3.2 ç¬¬äºŒéƒ¨æ•´åˆoutputå†…å®¹å’Œé«˜äº®æ ·å¼æ–‡æœ¬ï¼š
ç¬¬ä¸€æ­¥çš„æ“ä½œä»…ä»…å®Œæˆäº†ç”±**codeç‰‡æ®µ**åˆ°**html**ç»“æ„çš„è½¬æ¢ï¼Œä½†æ˜¯å®Œæˆé«˜äº®è¿˜éœ€è¦**æ ·å¼**é…åˆæ¸²æŸ“ï¼Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥é€šè¿‡åœ¨è¾“å‡º**output**å†…å®¹åˆ°**index.html**æ—¶å°†**hljs**ä¸­å–œæ¬¢çš„æ ·å¼æ–‡æ¡£è·¯å¾„ä¼ å…¥åˆ°**html**æ–‡ä»¶æ¥åŠ è½½~
```typescript
const output = md.render(rawMd);
const styles = `
<link rel="stylesheet" href="./node_modules/highlight.js/styles/a11y-dark.css">
`;
// è¾“å‡ºhtmlæ–‡æœ¬
fs.writeFileSync(path.resolve(__dirname, "../index.html"), `
${styles}
${output}
`);
```
æ›´å¤šçš„æ ·å¼æ–‡æ¡£å¯ä»¥åœ¨`./node_modules/highlight.js/styles`é€‰æ‹©~
## 4. å®ç°MDæ”¯æŒè‡ªå®šä¹‰å®¹å™¨
> è‡ªå®šä¹‰å®¹å™¨æ˜¯MDæ–‡æ¡£é»˜è®¤å¹¶ä¸æ”¯æŒçš„ä¸€ç§è¯­æ³•ï¼Œåœ¨Vuejsçš„æ–‡æ¡£æœ‰å¾ˆå¤šçš„åº”ç”¨ï¼Œå®ç°è‡ªå®šä¹‰å®¹æ˜“éœ€è¦ç”¨åˆ°`markdown-it-container`æ¨¡å—~

1. `markdownIt`é€šè¿‡æ’ä»¶çš„å½¢å¼åˆ©ç”¨`markdown-it-container`æ¥å®ç°è‡ªå®šä¹‰å®¹å™¨ï¼Œé€šè¿‡é…ç½®`validate`æ¥åšæ¸²æŸ“å‰çš„è¯­æ³•æ ¡éªŒï¼Œé€šè¿‡`render`å‡½æ•°æ¥ç»„ä¸­å®¹å™¨éƒ¨åˆ†çš„`HTML`ç»“æ„~
```
::: warning
*here be dragons*
:::

â†“â†“â†“â†“â†“â†“â†“â†“â†“â†“è½¬æ¢ä¸ºâ†“â†“â†“â†“â†“â†“â†“â†“â†“â†“

<div class="warning">
<em>here be dragons</em>
</div>
```
```typescript
md.use(require("markdown-it-container"), "warning", {
    validate: (params: string) => {
        return params.trim().match(/^warning+(.*)$/m);
    },
    render: (tokens: Array<Token>, idx: number) => {
        const m = tokens[idx].info.trim().match(/^warning+(.*)$/m);
        if (tokens[idx].nesting === 1) {
            return `<div class="warning">${md.utils.escapeHtml(m ? m[1] : '')}`
        } else {
            return '</div>\n';
        }
    }
})
```
æç¤ºï¼šé€šè¿‡`tokens[idx]`å–åˆ°çš„æ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤º~
![image.png](https://cdn.nlark.com/yuque/0/2022/png/2373519/1666018075021-43b9017c-2384-4c4b-8375-a5ea2a549c9c.png#clientId=ue457beec-ce64-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=604&id=jHcbM&margin=%5Bobject%20Object%5D&name=image.png&originHeight=604&originWidth=430&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22540&status=done&style=stroke&taskId=u855efdce-4359-4131-b656-c53c654390c&title=&width=430)

2. ä¸Šé¢çš„å¤„ç†ä¾æ—§æ˜¯**MD**åˆ°**HTML**ç»“æ„çš„è½¬æ¢ï¼Œåœ¨è‡ªå®šä¹‰å®¹å™¨çš„æ—¶å€™æˆ‘ä»¬é¢„ç•™çš„**css**åç§°ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦åœ¨è¾“å‡º`index.html`æ–‡ä»¶çš„æ—¶å€™è‡ªå®šä¹‰æ ·å¼æ–‡æ¡£~
```typescript
const output = md.render(rawMd);
const styles = `
<link rel="stylesheet" href="./node_modules/highlight.js/styles/a11y-dark.css">
<style>
    .warning{
        margin: 28px 0;
        padding: 10px 14px 4px 22px;
        border-radius: 8px;
        overflow-x: auto;
        transition: color .5s,background-color .5s;
        position: relative;
        font-size: 14px;
        line-height: 1.6;
        font-weight: 500;
        color: #0000008c;
        background-color: #f9f9f9;
        border: 1px solid #ffc517;
    }
    .hljs {
        padding: 5px 8px;
        border-radius: 5px;
    }
</style>
`;
// è¾“å‡ºhtmlæ–‡æœ¬
fs.writeFileSync(path.resolve(__dirname, "../index.html"), `
${styles}
${output}
`);
```
## 5. æ€»ç»“
é€šè¿‡ä½¿ç”¨`markdown-it`ã€`highlight.js`ã€`markdown-it-container`æ¨¡å—å®ç°äº†**Markdown**åˆ°**HTML**çš„æ–‡æ¡£è½¬æ¢ï¼Œä»£ç å—é«˜äº®å’Œè‡ªå®šä¹‰å®¹å™¨ï¼Œ**VItepress**æ­å»ºçš„ç»„ä»¶åº“æ–‡æ¡£ä¸­çš„ç»„ä»¶æ¸²æŸ“å’Œæºç å±•ç¤ºåŠŸèƒ½å°±éœ€è¦ç”¨åˆ°è‡ªå®šä¹‰å®¹å™¨çš„è§£æå’Œç»„è£…è‡ªå®šä¹‰çš„**Vue**ç»„ä»¶å®ç°é«˜çº§åŠŸèƒ½~
> æœ¬æ–‡é¡¹ç›®å·²æ¨é€è‡³GitHubï¼Œæ¬¢è¿å…‹éš†æ¼”ç¤ºï¼š`git clone [https://github.com/OSpoon/awesome-examples.git](https://github.com/OSpoon/awesome-examples.git)`


* * *

**å¦‚æœçœ‹å®Œè§‰å¾—æœ‰æ”¶è·ï¼Œæ¬¢è¿ç‚¹èµã€è¯„è®ºã€åˆ†äº«æ”¯æŒä¸€ä¸‹ã€‚ä½ çš„æ”¯æŒå’Œè‚¯å®šï¼Œæ˜¯æˆ‘åšæŒå†™ä½œçš„åŠ¨åŠ›~**

æœ€åå¯ä»¥å…³æ³¨æˆ‘@å°é‘«åŒå­¦ã€‚æ¬¢è¿[ç‚¹æ­¤æ‰«ç åŠ æˆ‘å¾®ä¿¡](https://it200.cn/ "https://it200.cn/")[fe-xiaoxin](https://it200.cn/ "https://it200.cn/")äº¤æµï¼Œå…±åŒè¿›æ­¥ï¼ˆè¿˜å¯ä»¥å¸®ä½ **fix**ğŸ›ï¼‰~